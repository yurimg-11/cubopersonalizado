<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>AR.js - Cubo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <script src="https://raw.githack.com/fcor/arjs-gestures/master/dist/gestures.js"></script>

  <style>
    #menu {
      position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
      z-index: 10; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;
      padding: 10px; background: rgba(255, 255, 255, 0.85); border-radius: 10px;
    }
    #menu button {
      padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 5px;
    }
    #menu button.active { background-color: #28a745; }
    #back-button { position: absolute; top: 20px; left: 20px; z-index: 10; padding: 10px; }
  </style>
</head>

<body style="margin : 0px; overflow: hidden;">

  <button id="back-button" onclick="window.location.href='index.html'">Volver</button>

  <div id="menu">
    <button class="active" data-asset-id="encefalo">encefalo</button>
    <button data-asset-id="esqueleto">Esqueleto</button>
    <button data-asset-id="s-solar">S. Solar</button>
    <button data-asset-id="corazon">Corazón</button>
    <button data-asset-id="mano">Mano</button>
    <button data-asset-id="volcan">Volcán</button>
  </div>

  <a-scene
    vr-mode-ui="enabled: false;"
    embedded
    renderer="logarithmicDepthBuffer: true;"
    arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
    gesture-detector>

    <a-assets>
      <a-asset-item id="encefalo"  src="modelos/encefalo_humano.glb"></a-asset-item>
      <a-asset-item id="esqueleto" src="modelos/skeleton_esqueleto_-_downloadable.glb"></a-asset-item>
      <a-asset-item id="s-solar"   src="modelos/solar_system_custom.glb"></a-asset-item>
      <a-asset-item id="corazon"   src="modelos/corazon__anim.glb"></a-asset-item>
      <a-asset-item id="mano"      src="modelos/hand_monster.glb"></a-asset-item>
      <a-asset-item id="volcan"    src="modelos/volcan_turrialba_santa_cruz_costa_rica.glb"></a-asset-item>
    </a-assets>

    <a-entity light="type: ambient; intensity: 2;"></a-entity>
    <a-entity light="type: directional; intensity: 1.5;" position="1 1 1"></a-entity>

    <a-marker type='barcode' value='0'><a-entity id="marker-0-content" rotation="-90 0 0"></a-entity></a-marker>
    <a-marker type='barcode' value='1'><a-entity id="marker-1-content" rotation="-90 0 0"></a-entity></a-marker>
    <a-marker type='barcode' value='2'><a-entity id="marker-2-content" rotation="-90 0 0"></a-entity></a-marker>
    <a-marker type='barcode' value='3'><a-entity id="marker-3-content" rotation="-90 0 0"></a-entity></a-marker>
    <a-marker type='barcode' value='4'><a-entity id="marker-4-content" rotation="-90 0 0"></a-entity></a-marker>
    <a-marker type='barcode' value='5'><a-entity id="marker-5-content" rotation="-90 0 0"></a-entity></a-marker>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      
      // *** AQUÍ AJUSTAMOS LOS TAMAÑOS ***
      const configuracionModelos = {
        'encefalo':  '0.01 0.01 0.01',   // Lo hacemos 10 veces más pequeño
        'esqueleto': '1 1 1',         // Normal
        's-solar':   '1 1 1',         // Normal
        'corazon':   '1 1 1',         // Normal (si sale grande, cambia a 0.1)
        'mano':      '1 1 1',         // Normal
        'volcan':    '0.01 0.01 0.01' // Volcán: 100 veces más pequeño
      };

      let currentModelAssetId = 'encefalo'; 

      function updateModelsInMarkers() {
        for (let i = 0; i <= 5; i++) {
          const markerContent = document.getElementById(`marker-${i}-content`);
          if (markerContent) {
            // Limpiar anterior
            const oldModels = markerContent.querySelectorAll('a-gltf-model');
            oldModels.forEach(model => model.remove());

            // Crear nuevo
            const newModel = document.createElement('a-gltf-model');
            newModel.setAttribute('gltf-model', `#${currentModelAssetId}`);
            newModel.setAttribute('class', 'collidable'); 
            
            // Aplicar escala personalizada
            const escala = configuracionModelos[currentModelAssetId] || '1 1 1';
            newModel.setAttribute('scale', escala);

            markerContent.appendChild(newModel); 
          }
        }
      }

      const menu = document.getElementById('menu');
      const buttons = document.querySelectorAll('#menu button');

      // Inicializar botón activo
      buttons.forEach(btn => {
        if (btn.getAttribute('data-asset-id') === currentModelAssetId) {
          btn.classList.add('active');
        }
      });
      updateModelsInMarkers(); 

      // Evento Click
      menu.addEventListener('click', (event) => {
        if (event.target.tagName !== 'BUTTON') return;

        buttons.forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');

        currentModelAssetId = event.target.getAttribute('data-asset-id');
        updateModelsInMarkers(); 
      });
    });
  </script>

</body>
</html>